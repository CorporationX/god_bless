–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —ç–ª–µ–∫—Ç—Ä–æ–ø–æ–¥—Å—Ç–∞–Ω—Ü–∏–π
derschrank2000-S04-T20-BJS2-51174
derschrank.sprint04.task20.bjstwo_51174

Sprint04. Task20/6. ConcurrentHashMap. Substations
------------------------------
–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —ç–ª–µ–∫—Ç—Ä–æ–ø–æ–¥—Å—Ç–∞–Ω—Ü–∏–π
üë©‚Äçüíª üß†üß† (–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞–¥–∞—á–∞)


–£—Å–ª–æ–≤–∏—è –∑–∞–¥–∞—á–∏
–°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –¥–∞–Ω–Ω—ã—Ö —ç–ª–µ–∫—Ç—Ä–æ–ø–æ–¥—Å—Ç–∞–Ω—Ü–∏–π –¥–æ–ª–∂–Ω–∞ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ, –ø–æ—Å—Ç—É–ø–∞—é—â–∏–µ —Å –¥–∞—Ç—á–∏–∫–æ–≤, –≤ —Ä–µ–∂–∏–º–µ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏. –î–∞–Ω–Ω—ã–µ —Å –¥–∞—Ç—á–∏–∫–æ–≤ –¥–æ–ª–∂–Ω—ã –∑–∞–ø–∏—Å—ã–≤–∞—Ç—å—Å—è –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å—Å—è –±—ã—Å—Ç—Ä–æ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ —Å —É—á—ë—Ç–æ–º —Ä–∞–±–æ—Ç—ã –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø–æ—Ç–æ–∫–æ–≤ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ. –î–ª—è —ç—Ç–æ–≥–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –∫–æ–ª–ª–µ–∫—Ü–∏–∏ –∏–∑ –ø–∞–∫–µ—Ç–∞ java.util.concurrent.

–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:
1Ô∏è‚É£ –°–æ–∑–¥–∞–π—Ç–µ –∫–ª–∞—Å—Å Sensor, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—â–∏–π –¥–∞—Ç—á–∏–∫. –ü–æ–ª—è:
id ‚Äî —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –¥–∞—Ç—á–∏–∫–∞,
substation ‚Äî —Å—Å—ã–ª–∫–∞ –Ω–∞ –æ–±—ä–µ–∫—Ç —ç–ª–µ–∫—Ç—Ä–æ–ø–æ–¥—Å—Ç–∞–Ω—Ü–∏–∏.
–ù–∞–ø–∏—à–∏—Ç–µ –º–µ—Ç–æ–¥ startGeneratingData() ‚Äî –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å–ª—É—á–∞–π–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Ç–∏–ø–∞ double –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∏—Ö –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é —ç–ª–µ–∫—Ç—Ä–æ–ø–æ–¥—Å—Ç–∞–Ω—Ü–∏—é. –î–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –≤ –º–µ—Ç–æ–¥ receiveData() –∫–ª–∞—Å—Å–∞ Substation.

2Ô∏è‚É£ –°–æ–∑–¥–∞–π—Ç–µ –∫–ª–∞—Å—Å Substation, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—â–∏–π —ç–ª–µ–∫—Ç—Ä–æ–ø–æ–¥—Å—Ç–∞–Ω—Ü–∏—é. –ü–æ–ª—è:
id ‚Äî —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ–¥—Å—Ç–∞–Ω—Ü–∏–∏,
monitoringSystem ‚Äî —Å—Å—ã–ª–∫–∞ –Ω–∞ –æ–±—ä–µ–∫—Ç —Å–∏—Å—Ç–µ–º—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ (—Ç–∏–ø MonitoringSystem),
sensorDataMap ‚Äî –ø–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω–∞—è –∫–æ–ª–ª–µ–∫—Ü–∏—è –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –æ—Ç –≤—Å–µ—Ö –¥–∞—Ç—á–∏–∫–æ–≤ –ø–æ–¥—Å—Ç–∞–Ω—Ü–∏–∏ (ConcurrentHashMap<Integer, SensorData>).
–ú–µ—Ç–æ–¥—ã:
receiveData(int sensorId, double data) ‚Äî –ø–æ–ª—É—á–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –æ—Ç –¥–∞—Ç—á–∏–∫–æ–≤ –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –∏—Ö –≤ sensorDataMap.
startCalculatingAverages() ‚Äî –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É –≤—ã—á–∏—Å–ª—è–µ—Ç —Å—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Å–æ –≤—Å–µ—Ö –¥–∞—Ç—á–∏–∫–æ–≤ –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∏—Ö –≤ —Å–∏—Å—Ç–µ–º—É –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ ScheduledExecutorService –¥–ª—è –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π).

3Ô∏è‚É£ –°–æ–∑–¥–∞–π—Ç–µ –∫–ª–∞—Å—Å SensorData, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö –æ—Ç –¥–∞—Ç—á–∏–∫–æ–≤. –ü–æ–ª—è:
sum ‚Äî —Å—É–º–º–∞ –≤—Å–µ—Ö –∑–Ω–∞—á–µ–Ω–∏–π –¥–∞–Ω–Ω—ã—Ö, –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã—Ö —ç—Ç–∏–º —Å–µ–Ω—Å–æ—Ä–æ–º,
count ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.
–ú–µ—Ç–æ–¥—ã:
addData(double data) ‚Äî –¥–æ–±–∞–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ —Å—É–º–º–∞—Ä–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∏ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —Å—á—ë—Ç—á–∏–∫,
getAverage() ‚Äî –≤—ã—á–∏—Å–ª—è–µ—Ç —Å—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö.

4Ô∏è‚É£ –°–æ–∑–¥–∞–π—Ç–µ –∫–ª–∞—Å—Å MonitoringSystem, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—â–∏–π —Å–∏—Å—Ç–µ–º—É –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞:
–î–æ–±–∞–≤—å—Ç–µ –ø–æ–ª–µ substationData ‚Äî –ø–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω–∞—è –∫–æ–ª–ª–µ–∫—Ü–∏—è –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –≤—Å–µ—Ö –ø–æ–¥—Å—Ç–∞–Ω—Ü–∏–π (ConcurrentHashMap<Integer, Double>).
–°–æ–∑–¥–∞–π—Ç–µ –º–µ—Ç–æ–¥ updateData(int substationId, double averageData) ‚Äî –æ–±–Ω–æ–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –æ—Ç –ø–æ–¥—Å—Ç–∞–Ω—Ü–∏–∏ –∏ –≤—ã–≤–æ–¥–∏—Ç –∏—Ö –≤ –∫–æ–Ω—Å–æ–ª—å.

5Ô∏è‚É£ –í –∫–ª–∞—Å—Å–µ Main:
–°–æ–∑–¥–∞–π—Ç–µ –æ–±—ä–µ–∫—Ç MonitoringSystem –∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ –æ–±—ä–µ–∫—Ç–æ–≤ Substation.
–î–ª—è –∫–∞–∂–¥–æ–π –ø–æ–¥—Å—Ç–∞–Ω—Ü–∏–∏ —Å–æ–∑–¥–∞–π—Ç–µ –º–∏–Ω–∏–º—É–º 10 –¥–∞—Ç—á–∏–∫–æ–≤.
–ó–∞–ø—É—Å—Ç–∏—Ç–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –¥–∞–Ω–Ω—ã—Ö –∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ —Å—Ä–µ–¥–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π –¥–ª—è –∫–∞–∂–¥–æ–π –ø–æ–¥—Å—Ç–∞–Ω—Ü–∏–∏.
–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –æ–±–Ω–æ–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ —Å –∫–∞–∂–¥–æ–π –ø–æ–¥—Å—Ç–∞–Ω—Ü–∏–∏ –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É.

–ü–æ—á–µ–º—É —ç—Ç–∞ –∑–∞–¥–∞—á–∞ –ø–æ–ª–µ–∑–Ω–∞?
–ó–∞–¥–∞—á–∞ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç, –∫–∞–∫ —Å–æ–∑–¥–∞–≤–∞—Ç—å —Å–∏—Å—Ç–µ–º—É –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞, –∫–æ—Ç–æ—Ä–∞—è —Å–æ–±–∏—Ä–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ —Å –¥–∞—Ç—á–∏–∫–æ–≤, –∞–≥—Ä–µ–≥–∏—Ä—É–µ—Ç –∏—Ö –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é. –¢–∞–∫–∏–µ —Å–∏—Å—Ç–µ–º—ã —à–∏—Ä–æ–∫–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –æ—Ç—Ä–∞—Å–ª—è—Ö, —Ç–∞–∫–∏—Ö –∫–∞–∫ –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ—Å—Ç—å, —ç–Ω–µ—Ä–≥–µ—Ç–∏–∫–∞, —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç –∏ —Å–µ—Ç–µ–≤—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏. –ü–æ–¥–æ–±–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –º–æ–≥—É—Ç –±—ã—Ç—å –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω—ã –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã –≤ —Ä–µ–∞–ª—å–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–∞—Ö, —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å–æ —Å–±–æ—Ä–æ–º –∏ –∞–Ω–∞–ª–∏–∑–æ–º –¥–∞–Ω–Ω—ã—Ö —Å –¥–∞—Ç—á–∏–∫–æ–≤ –∏ –¥—Ä—É–≥–∏—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤. –†–µ—à–µ–Ω–∏–µ —ç—Ç–æ–π –∑–∞–¥–∞—á–∏ –º–æ–∂–µ—Ç —Å—Ç–∞—Ç—å –æ—Ç–ø—Ä–∞–≤–Ω–æ–π —Ç–æ—á–∫–æ–π –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã—Ö –∏ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –±—ã—Ç—å –ø—Ä–∏–º–µ–Ω–µ–Ω—ã –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ.
------------------------------
22:06:55: Executing ':derschrank.sprint04.task20.bjstwo_51174.Main.main()'‚Ä¶

> Task :compileJava
> Task :processResources NO-SOURCE
> Task :classes

> Task :derschrank.sprint04.task20.bjstwo_51174.Main.main()

=============================
Starting schedule...
=============================

Substation: 3, average amount: 67,688627
Substation: 9, average amount: 57,611100
Substation: 8, average amount: 40,179243
Substation: 7, average amount: 61,034587
Substation: 6, average amount: 54,336491
Substation: 4, average amount: 46,010346
Substation: 5, average amount: 31,197796
...
Substation: 7, average amount: 53,366041
Substation: 1, average amount: 49,130615
Substation: 8, average amount: 45,265515
Substation: 5, average amount: 48,786737
Substation: 6, average amount: 51,438017
Substation: 0, average amount: 52,868086
Substation: 5, average amount: 49,892201

=============================
Stopping schedule...
=============================

Substation: 1, average amount: 47,698624
Substation: 4, average amount: 50,769374
Substation: 3, average amount: 53,798293
Substation: 7, average amount: 54,089220
Substation: 8, average amount: 45,265515
Substation: 9, average amount: 48,778960
Substation: 6, average amount: 52,187095
Substation: 2, average amount: 48,524941