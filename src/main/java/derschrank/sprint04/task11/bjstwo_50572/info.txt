–†–∞—Å—Å—ã–ª–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ Facebook
derschrank2000-S04-T11-BJS2-50572
derschrank.sprint04.task11.bjstwo_50572

Sprint04. Task11. CompletableFuture. Notification Facebook

-----------------------------------
–†–∞—Å—Å—ã–ª–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ Facebook
üë©‚Äçüíª üß†üß† (–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞–¥–∞—á–∞)


–£—Å–ª–æ–≤–∏—è –∑–∞–¥–∞—á–∏
–í–∞–º –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å —Å–∏—Å—Ç–µ–º—É —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –¥–ª—è Facebook, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –ø–æ–ª—É—á–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∏ –¥–æ–±–∞–≤–ª—è—Ç—å –∏—Ö –≤ –æ–±—â–∏–π —Å–ø–∏—Å–æ–∫. –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å CompletableFuture –¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –∏ synchronized –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –æ–±—â–µ–º—É —Å–ø–∏—Å–∫—É —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π.

–¶–µ–ª—å:
–°–æ–∑–¥–∞–π—Ç–µ –ø—Ä–æ–≥—Ä–∞–º–º—É, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ –æ–±—â–∏–π —Å–ø–∏—Å–æ–∫ –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–æ—Å—Ç—É–ø –∫ —ç—Ç–æ–º—É —Å–ø–∏—Å–∫—É —Å –ø–æ–º–æ—â—å—é synchronized.

–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:
1Ô∏è‚É£ –°–æ–∑–¥–∞–π—Ç–µ –∫–ª–∞—Å—Å Notification, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —Å –ø–æ–ª—è–º–∏:
id ‚Äî —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (—Ç–∏–ø int),
message ‚Äî —Å–æ–æ–±—â–µ–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (—Ç–∏–ø String).
–°–æ–∑–¥–∞–π—Ç–µ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –∏ –º–µ—Ç–æ–¥—ã getters –¥–ª—è —ç—Ç–∏—Ö –ø–æ–ª–µ–π.

2Ô∏è‚É£ –°–æ–∑–¥–∞–π—Ç–µ –∫–ª–∞—Å—Å NotificationManager, –∫–æ—Ç–æ—Ä—ã–π —É–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏. –í –Ω–µ–º –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Å–ø–∏—Å–æ–∫ List<Notification>, –∫–æ—Ç–æ—Ä—ã–π —Ö—Ä–∞–Ω–∏—Ç –≤—Å–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è.

3Ô∏è‚É£ –†–µ–∞–ª–∏–∑—É–π—Ç–µ –º–µ—Ç–æ–¥ synchronized addNotification(Notification notification), –∫–æ—Ç–æ—Ä—ã–π –¥–æ–±–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ —Å–ø–∏—Å–æ–∫. –ü–æ–¥—É–º–∞–π—Ç–µ, –ø–æ—á–µ–º—É –æ–Ω –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å synchronized? –ö–∞–∫–∞—è —É –Ω–∞—Å –º–æ—Ç–∏–≤–∞—Ü–∏—è –µ–≥–æ –¥–µ–ª–∞—Ç—å —Ç–∞–∫–æ–≤—ã–º?

4Ô∏è‚É£ –°–æ–∑–¥–∞–π—Ç–µ –º–µ—Ç–æ–¥ fetchNotification(), –∫–æ—Ç–æ—Ä—ã–π –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ —Å–æ–∑–¥–∞–µ—Ç –Ω–æ–≤–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∏ –¥–æ–±–∞–≤–ª—è–µ—Ç –µ–≥–æ –≤ —Å–ø–∏—Å–æ–∫ —á–µ—Ä–µ–∑ –≤—ã–∑–æ–≤ addNotification. –ò–º–∏—Ç–∏—Ä—É–π—Ç–µ –∑–∞–¥–µ—Ä–∂–∫—É —Å –ø–æ–º–æ—â—å—é Thread.sleep –≤–Ω—É—Ç—Ä–∏ –∑–∞–¥–∞—á–∏.

5Ô∏è‚É£ –í—ã–∑–æ–≤–∏—Ç–µ –º–µ—Ç–æ–¥ fetchNotification –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –≤ —Ü–∏–∫–ª–µ, —Å–æ–±–∏—Ä–∞—è CompletableFuture –¥–ª—è –∫–∞–∂–¥–æ–π –∑–∞–¥–∞—á–∏ –≤ —Å–ø–∏—Å–æ–∫.

6Ô∏è‚É£ –û–∂–∏–¥–∞–π—Ç–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤—Å–µ—Ö –∑–∞–¥–∞—á, –∏—Å–ø–æ–ª—å–∑—É—è CompletableFuture.allOf(), –∏ –≤—ã–≤–µ–¥–∏—Ç–µ —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π.

–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:
public class FacebookNotificationSystem {
    public static void main(String[] args) {
        NotificationManager manager = new NotificationManager();

        // –ó–∞–ø—É—Å–∫ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
        List<CompletableFuture<Void>> futures = IntStream.range(0, 10)
            .mapToObj(i -> manager.fetchNotification(i, "–°–æ–æ–±—â–µ–Ω–∏–µ " + i))
            .collect(Collectors.toList());

        // –û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤—Å–µ—Ö –∑–∞–¥–∞—á
        CompletableFuture<Void> allFutures = CompletableFuture.allOf(futures.toArray(new CompletableFuture[0]));
        allFutures.join(); // –ñ–¥–µ–º –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è

        // –í—ã–≤–æ–¥ –≤—Å–µ—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
        manager.printNotifications();
    }
}

–ü–æ—á–µ–º—É —ç—Ç–∞ –∑–∞–¥–∞—á–∞ –ø–æ–ª–µ–∑–Ω–∞?
–ü—Ä–æ–±–ª–µ–º–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø–æ—Ç–æ–∫–æ–≤ ‚Äî –æ—á–µ–Ω—å –≤–∞–∂–Ω–∞—è —Ç–µ–º–∞ –≤ –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç–∏. –ò –∫–æ–≥–¥–∞ –≤—ã —Ä–∞–±–æ—Ç–∞–µ—Ç–µ —Å –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º –∑–∞–¥–∞—á, —Ç–æ –æ–Ω–∞ –Ω–µ —Ç–µ—Ä—è–µ—Ç —Å–≤–æ–µ–π –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç–∏, –≤–µ–¥—å –≤—Å–µ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –≤ —Ä–∞–∑–Ω—ã—Ö –ø–æ—Ç–æ–∫–∞—Ö. –ï—Å–ª–∏ –æ–Ω–∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É—é—Ç —Å –∫–∞–∫–∏–º-—Ç–æ –æ–±—â–∏–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º, —Ç–æ –¥–æ—Å—Ç—É–ø –∫ –Ω–µ–º—É –Ω—É–∂–Ω–æ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å

–¢–∞–∫–æ–π –ø–æ–¥—Ö–æ–¥ –≤—ã —É–≤–∏–¥–∏—Ç–µ –≤–æ–æ–±—â–µ –≤ –ª—é–±–æ–π —Å–µ—Ä—å–µ–∑–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ. –ù–∞–ø—Ä–∏–º–µ—Ä, –∑–¥–µ—Å—å –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –º—ã –º–æ–≥–ª–∏ –±—ã —Å–æ–±–∏—Ä–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã—Ö –Ω–æ—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è—Ö –≤ Facebook –≤ –∫–∞–∫—É—é-—Ç–æ –æ–±—â—É—é –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö (—É –Ω–∞—Å –ø—Ä–æ—Å—Ç–æ —Å–ø–∏—Å–æ–∫), –∞ –∑–∞—Ç–µ–º —Å–ª–µ–¥–∏—Ç—å, —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —Å–∫–æ–ª—å–∫–æ –Ω–æ—Ç–∏—Ñ–∏–∫–∞—Ü–∏–π –Ω–∞—à —Å–µ—Ä–≤–∏—Å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∏ –∑–∞ –∫–∞–∫–æ–π-—Ç–æ –ø–µ—Ä–∏–æ–¥ –≤—Ä–µ–º–µ–Ω–∏. –≠—Ç–æ –∑–∞–¥–∞—á–∞ observability –≤ –±–æ–ª—å—à–∏—Ö —Å–∏—Å—Ç–µ–º–∞—Ö, —Ç.–µ. –Ω–∞–±–ª—é–¥–µ–Ω–∏—è –∑–∞ —Ä–∞–±–æ—Ç–æ–π —Å–µ—Ä–≤–∏—Å–æ–≤.

–ù–∞–±–ª—é–¥–∞—Ç—å –∑–∞ —Å–µ—Ä–≤–∏—Å–∞–º–∏ –æ—á–µ–Ω—å –≤–∞–∂–Ω–æ –¥–ª—è –≥–∞—Ä–∞–Ω—Ç–∏–∏ –∫–∞—á–µ—Å—Ç–≤–∞ —Ä–∞–±–æ—Ç—ã –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Å–µ—Ä—å–µ–∑–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π.
-----------------------------------
19:16:18: Executing ':derschrank.sprint04.task11.bjstwo_50572.Main.main()'‚Ä¶

> Task :compileJava
> Task :processResources NO-SOURCE
> Task :classes

> Task :derschrank.sprint04.task11.bjstwo_50572.Main.main()
Message was added: [0] Message #0
Message was added: [6] Message #6
Message was added: [2] Message #2
Message was added: [5] Message #5
Message was added: [3] Message #3
Message was added: [1] Message #1
Message was added: [4] Message #4
Message was added: [8] Message #8
Message was added: [7] Message #7
Message was added: [10] Message #10
Message was added: [11] Message #11
Message was added: [13] Message #13
Message was added: [9] Message #9
Message was added: [12] Message #12
Message was added: [15] Message #15
Message was added: [16] Message #16
Message was added: [14] Message #14
Message was added: [17] Message #17
Message was added: [18] Message #18
Message was added: [19] Message #19
Message was added: [20] Message #20
Message was added: [22] Message #22
Message was added: [23] Message #23
Message was added: [21] Message #21
Message was added: [27] Message #27
Message was added: [25] Message #25
Message was added: [24] Message #24
Message was added: [26] Message #26
Message was added: [28] Message #28
Message was added: [30] Message #30
Message was added: [29] Message #29
Message was added: [32] Message #32
Message was added: [33] Message #33
Message was added: [31] Message #31
Message was added: [34] Message #34
Message was added: [35] Message #35
Message was added: [36] Message #36
Message was added: [37] Message #37
Message was added: [38] Message #38
Message was added: [39] Message #39
Message was added: [40] Message #40
Message was added: [41] Message #41
Message was added: [43] Message #43
Message was added: [44] Message #44
Message was added: [42] Message #42
Message was added: [45] Message #45
Message was added: [48] Message #48
Message was added: [47] Message #47
Message was added: [46] Message #46
Message was added: [51] Message #51
Message was added: [50] Message #50
Message was added: [49] Message #49
Message was added: [53] Message #53
Message was added: [52] Message #52
Message was added: [54] Message #54
Message was added: [55] Message #55
Message was added: [56] Message #56
Message was added: [58] Message #58
Message was added: [57] Message #57
Message was added: [59] Message #59
Message was added: [61] Message #61
Message was added: [62] Message #62
Message was added: [60] Message #60
Message was added: [65] Message #65
Message was added: [63] Message #63
Message was added: [64] Message #64
Message was added: [69] Message #69
Message was added: [66] Message #66
Message was added: [68] Message #68
Message was added: [67] Message #67
Message was added: [70] Message #70
Message was added: [71] Message #71
Message was added: [72] Message #72
Message was added: [73] Message #73
Message was added: [74] Message #74
Message was added: [76] Message #76
Message was added: [75] Message #75
Message was added: [79] Message #79
Message was added: [80] Message #80
Message was added: [77] Message #77
Message was added: [78] Message #78
Message was added: [81] Message #81
Message was added: [82] Message #82
Message was added: [83] Message #83
Message was added: [84] Message #84
Message was added: [85] Message #85
Message was added: [86] Message #86
Message was added: [88] Message #88
Message was added: [87] Message #87
Message was added: [89] Message #89
Message was added: [90] Message #90
Message was added: [95] Message #95
Message was added: [91] Message #91
Message was added: [93] Message #93
Message was added: [94] Message #94
Message was added: [92] Message #92
Message was added: [97] Message #97
Message was added: [96] Message #96
Message was added: [98] Message #98
Message was added: [99] Message #99
[2] Message #2
[6] Message #6
[5] Message #5
[1] Message #1
[3] Message #3
[0] Message #0
[4] Message #4
[7] Message #7
[9] Message #9
[10] Message #10
[8] Message #8
[11] Message #11
[12] Message #12
[13] Message #13
[15] Message #15
[16] Message #16
[14] Message #14
[17] Message #17
///
[95] Message #95
[93] Message #93
[91] Message #91
[92] Message #92
[97] Message #97
[96] Message #96
[99] Message #99
[98] Message #98

BUILD SUCCESSFUL in 21s
2 actionable tasks: 2 executed
19:16:40: Execution finished ':derschrank.sprint04.task11.bjstwo_50572.Main.main()'.
